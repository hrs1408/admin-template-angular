<div class="profile-settings">
  <h1>Cài đặt thông tin</h1>

  <div class="settings-container">
    <!-- Thông tin cá nhân -->
    <div class="settings-card">
      <h2>Thông tin cá nhân</h2>
      <form [formGroup]="profileForm" (ngSubmit)="onUpdateProfile()">
        <div class="avatar-section">
          <div class="avatar-preview" [style.backgroundImage]="'url(' + (avatarPreview || 'assets/images/default-avatar.png') + ')'">
            <input type="file" accept="image/*" (change)="onAvatarChange($event)" #fileInput>
            <button type="button" class="change-avatar-btn" (click)="fileInput.click()">
              <i class="fas fa-camera"></i>
            </button>
          </div>
        </div>

        <div class="form-group">
          <label for="fullName">Họ và tên</label>
          <input type="text" id="fullName" formControlName="fullName" class="form-control">
          <div class="error-message" *ngIf="profileForm.get('fullName')?.touched && profileForm.get('fullName')?.invalid">
            {{ getErrorMessage('fullName', profileForm) }}
          </div>
        </div>

        <div class="form-group">
          <label for="email">Email</label>
          <input type="email" id="email" formControlName="email" class="form-control">
          <div class="error-message" *ngIf="profileForm.get('email')?.touched && profileForm.get('email')?.invalid">
            {{ getErrorMessage('email', profileForm) }}
          </div>
        </div>

        <div class="form-group">
          <label for="phone">Số điện thoại</label>
          <input type="tel" id="phone" formControlName="phone" class="form-control">
          <div class="error-message" *ngIf="profileForm.get('phone')?.touched && profileForm.get('phone')?.invalid">
            {{ getErrorMessage('phone', profileForm) }}
          </div>
        </div>

        <button type="submit" class="btn-primary">
          <i class="fas fa-save"></i>
          Lưu thay đổi
        </button>
      </form>
    </div>

    <!-- Đổi mật khẩu -->
    <div class="settings-card">
      <h2>Đổi mật khẩu</h2>
      <form [formGroup]="passwordForm" (ngSubmit)="onChangePassword()">
        <div class="form-group">
          <label for="currentPassword">Mật khẩu hiện tại</label>
          <input type="password" id="currentPassword" formControlName="currentPassword" class="form-control">
          <div class="error-message" *ngIf="passwordForm.get('currentPassword')?.touched && passwordForm.get('currentPassword')?.invalid">
            {{ getErrorMessage('currentPassword', passwordForm) }}
          </div>
        </div>

        <div class="form-group">
          <label for="newPassword">Mật khẩu mới</label>
          <input type="password" id="newPassword" formControlName="newPassword" class="form-control">
          <div class="error-message" *ngIf="passwordForm.get('newPassword')?.touched && passwordForm.get('newPassword')?.invalid">
            {{ getErrorMessage('newPassword', passwordForm) }}
          </div>
        </div>

        <div class="form-group">
          <label for="confirmPassword">Xác nhận mật khẩu mới</label>
          <input type="password" id="confirmPassword" formControlName="confirmPassword" class="form-control">
          <div class="error-message" *ngIf="passwordForm.get('confirmPassword')?.touched && passwordForm.get('confirmPassword')?.invalid">
            {{ getErrorMessage('confirmPassword', passwordForm) }}
          </div>
          <div class="error-message" *ngIf="passwordForm.hasError('mismatch') && passwordForm.get('confirmPassword')?.touched">
            {{ getPasswordMatchError() }}
          </div>
        </div>

        <button type="submit" class="btn-primary">
          <i class="fas fa-key"></i>
          Đổi mật khẩu
        </button>
      </form>
    </div>
  </div>
</div>
